{"ast":null,"code":"var _jsxFileName = \"/home/erick/Documentos/Entregas-Kenzie/Q2-Entregas/sprint-4/habit-management-group4/src/providers/AuthContext.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useState, createContext, useContext } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport api from \"../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext({});\n\nconst useAuth = () => {\n  _s();\n\n  const context = useContext(AuthContext);\n  return context;\n};\n\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nconst AuthProvider = ({\n  children\n}) => {\n  _s2();\n\n  const [data, setData] = useState(() => {\n    const id = localStorage.getItem(\"@gestaodehabitos:id\");\n    const access = localStorage.getItem(\"@gestaodehabitos:access\");\n\n    if (id && access) {\n      return {\n        access,\n        id\n      };\n    }\n\n    return {};\n  });\n  const [token] = useState(JSON.parse(localStorage.getItem(\"@gestaohabitos:access\")));\n  const tokenBearer = {\n    headers: {\n      Authorization: `Bearer: ${token}`\n    }\n  };\n\n  const signIn = async data => {\n    const response = await api.post(\"/sessions/\", data);\n    const {\n      access\n    } = response.data;\n    const {\n      user_id\n    } = jwt_decode(access);\n    localStorage.setItem(\"@gestaodehabitos:id\", JSON.stringify(user_id));\n    localStorage.setItem(\"@gestaodehabitos:access\", JSON.stringify(access));\n    setData({\n      user_id,\n      access\n    });\n  };\n\n  const signOut = () => {\n    localStorage.removeItem(\"@gestaodehabitos:id\");\n    localStorage.removeItem(\"@gestaodehabitos:access\");\n    setData({});\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      access: data.access,\n      id: data.id,\n      signIn,\n      signOut,\n      tokenBearer\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(AuthProvider, \"/OklNbej7ZAL6ZYf/2CKavpQscY=\");\n\n_c = AuthProvider;\nexport { AuthProvider, useAuth };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/home/erick/Documentos/Entregas-Kenzie/Q2-Entregas/sprint-4/habit-management-group4/src/providers/AuthContext.jsx"],"names":["useState","createContext","useContext","jwt_decode","api","AuthContext","useAuth","context","AuthProvider","children","data","setData","id","localStorage","getItem","access","token","JSON","parse","tokenBearer","headers","Authorization","signIn","response","post","user_id","setItem","stringify","signOut","removeItem"],"mappings":";;;;AAAA,SAASA,QAAT,EAAmBC,aAAnB,EAAkCC,UAAlC,QAAoD,OAApD;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,GAAP,MAAgB,iBAAhB;;AAEA,MAAMC,WAAW,gBAAGJ,aAAa,CAAC,EAAD,CAAjC;;AAEA,MAAMK,OAAO,GAAG,MAAM;AAAA;;AACpB,QAAMC,OAAO,GAAGL,UAAU,CAACG,WAAD,CAA1B;AACA,SAAOE,OAAP;AACD,CAHD;;GAAMD,O;;AAKN,MAAME,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AACrC,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBX,QAAQ,CAAC,MAAM;AACrC,UAAMY,EAAE,GAAGC,YAAY,CAACC,OAAb,CAAqB,qBAArB,CAAX;AACA,UAAMC,MAAM,GAAGF,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAf;;AAEA,QAAIF,EAAE,IAAIG,MAAV,EAAkB;AAChB,aAAO;AAAEA,QAAAA,MAAF;AAAUH,QAAAA;AAAV,OAAP;AACD;;AAED,WAAO,EAAP;AACD,GAT+B,CAAhC;AAWA,QAAM,CAACI,KAAD,IAAUhB,QAAQ,CACtBiB,IAAI,CAACC,KAAL,CAAWL,YAAY,CAACC,OAAb,CAAqB,uBAArB,CAAX,CADsB,CAAxB;AAIA,QAAMK,WAAW,GAAG;AAClBC,IAAAA,OAAO,EAAE;AACPC,MAAAA,aAAa,EAAG,WAAUL,KAAM;AADzB;AADS,GAApB;;AAMA,QAAMM,MAAM,GAAG,MAAOZ,IAAP,IAAgB;AAC7B,UAAMa,QAAQ,GAAG,MAAMnB,GAAG,CAACoB,IAAJ,CAAS,YAAT,EAAuBd,IAAvB,CAAvB;AAEA,UAAM;AAAEK,MAAAA;AAAF,QAAaQ,QAAQ,CAACb,IAA5B;AAEA,UAAM;AAAEe,MAAAA;AAAF,QAActB,UAAU,CAACY,MAAD,CAA9B;AAEAF,IAAAA,YAAY,CAACa,OAAb,CAAqB,qBAArB,EAA4CT,IAAI,CAACU,SAAL,CAAeF,OAAf,CAA5C;AACAZ,IAAAA,YAAY,CAACa,OAAb,CAAqB,yBAArB,EAAgDT,IAAI,CAACU,SAAL,CAAeZ,MAAf,CAAhD;AAEAJ,IAAAA,OAAO,CAAC;AAAEc,MAAAA,OAAF;AAAWV,MAAAA;AAAX,KAAD,CAAP;AACD,GAXD;;AAaA,QAAMa,OAAO,GAAG,MAAM;AACpBf,IAAAA,YAAY,CAACgB,UAAb,CAAwB,qBAAxB;AACAhB,IAAAA,YAAY,CAACgB,UAAb,CAAwB,yBAAxB;AAEAlB,IAAAA,OAAO,CAAC,EAAD,CAAP;AACD,GALD;;AAOA,sBACE,QAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLI,MAAAA,MAAM,EAAEL,IAAI,CAACK,MADR;AAELH,MAAAA,EAAE,EAAEF,IAAI,CAACE,EAFJ;AAGLU,MAAAA,MAHK;AAILM,MAAAA,OAJK;AAKLT,MAAAA;AALK,KADT;AAAA,cASGV;AATH;AAAA;AAAA;AAAA;AAAA,UADF;AAaD,CAvDD;;IAAMD,Y;;KAAAA,Y;AAyDN,SAASA,YAAT,EAAuBF,OAAvB","sourcesContent":["import { useState, createContext, useContext } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport api from \"../services/api\";\n\nconst AuthContext = createContext({});\n\nconst useAuth = () => {\n  const context = useContext(AuthContext);\n  return context;\n};\n\nconst AuthProvider = ({ children }) => {\n  const [data, setData] = useState(() => {\n    const id = localStorage.getItem(\"@gestaodehabitos:id\");\n    const access = localStorage.getItem(\"@gestaodehabitos:access\");\n\n    if (id && access) {\n      return { access, id };\n    }\n\n    return {};\n  });\n\n  const [token] = useState(\n    JSON.parse(localStorage.getItem(\"@gestaohabitos:access\"))\n  );\n\n  const tokenBearer = {\n    headers: {\n      Authorization: `Bearer: ${token}`,\n    },\n  };\n\n  const signIn = async (data) => {\n    const response = await api.post(\"/sessions/\", data);\n\n    const { access } = response.data;\n\n    const { user_id } = jwt_decode(access);\n\n    localStorage.setItem(\"@gestaodehabitos:id\", JSON.stringify(user_id));\n    localStorage.setItem(\"@gestaodehabitos:access\", JSON.stringify(access));\n\n    setData({ user_id, access });\n  };\n\n  const signOut = () => {\n    localStorage.removeItem(\"@gestaodehabitos:id\");\n    localStorage.removeItem(\"@gestaodehabitos:access\");\n\n    setData({});\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        access: data.access,\n        id: data.id,\n        signIn,\n        signOut,\n        tokenBearer,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport { AuthProvider, useAuth };\n"]},"metadata":{},"sourceType":"module"}